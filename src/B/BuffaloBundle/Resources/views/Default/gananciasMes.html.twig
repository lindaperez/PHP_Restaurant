{% extends 'layout.html.twig' %}

{% block content %}

<script src="{{ asset('bundles/techt/js/highcharts.js') }}" type="text/javascript"></script>
<script src="{{ asset('bundles/techt/js/exporting.js') }}" type="text/javascript"></script>


    
  <div class="container" >
    
    <section class="register">
<div id="container" style="min-width: 310px; height: 400px; margin: 0 auto"></div>
    </section>
  </div>


<script>
    $(function () {

        var data = {
            
        };
                    $.ajax({
                        type: 'post',
                        url: '{{ path("gananciasMes") }}',
                        data: data,
                        dataType: 'json',
                        success: function(data) {
                            if (data.error !== undefined && data.error !== '') {
                                alert(data.error);
                            } else {
                                if (data.length!== undefined ){
                                    var values=new Array();
                                    var dia=data[0].dia;
                                    var mes=data[0].mes;
                                    var ano=data[0].ano;
                                    for (var i=0, total = data.length; i < total; i++) {
                                        values[i]=[Date.UTC(data[i].ano, (data[i].mes-1),
                                            data[i].dia),data[i].costo];
                                  //     alert(values[i]);
                                    }
     $('#container').highcharts({
            chart: {
                type: 'spline'
            },
            title: {
                text: 'Ganancias Mensuales'
            },
            subtitle: {
                text: document.ontouchstart === undefined ?
                'Haz click de un punto a otro encima del\n\
                    grafico para ver la zona seleccionada en zoom' :
                'Haz click de un punto a otro encima del \n\
                    grafico para ver la zona seleccionada en zoom'

            },
            xAxis: {
               type: 'datetime',
               minRange: 200 * 24 * 3600000,
               text: 'Meses'
            },
            // fourteen days
            yAxis: {
                title: {
                    text: 'Bsf'
                },
                min: 4000,
                minRange: 400
                
            },
            tooltip: {
                formatter: function(){
                      return '<b> Ganancia Bf: '+ this.point.y +'</b><br/>'+ '<br>\n\
                        Fecha de Compra: '+ Highcharts.dateFormat('%d-%m-%Y', this.point.x);
                }
            },
                       plotOptions: {
                area: {
                    fillColor: {
                        linearGradient: { x1: 0, y1: 0, x2: 1, y2: 1},
                        stops: [
                            [0, Highcharts.getOptions().colors[0]],
                            [1, Highcharts.Color(Highcharts.getOptions().colors[0]).setOpacity(0).get('rgba')]
                        ]
                    },
                    marker: {
                        radius: 4
                    },
                    lineWidth: 1,
                    states: {
                        hover: {
                            lineWidth: 1
                        }
                    },
                    threshold: null
                }
            },
            series: [{
                name: 'Curva de Ganancias por Cada Mes',
                pointInterval: 24 * 3600 * 10000,
                pointStart: Date.UTC(ano, (mes-1), dia),
                // Define the data points. All series have a dummy year
                // of 1970/71 in order to be compared on the same x axis. Note
                // that in JavaScript, months start at 0 for January, 1 for February etc.
                data:values
            }]
        });                                        
        
                                }else{
                                    alert('No Data');
                                }
                            }
                        },
                        error: function(e, ts, et) {
                            alert(ts);
                            
                        }
                    });
        
                            
        
    
    });
    

    </script>
{% endblock %}
